Connection via Shared Resources
%ul
  - klass.metrics_by_token.each do |group|
    %li
      with 
      = raw print_res_list(group[:involved])
      %strong= group[:aggregate]
    - group[:details].each do |metric|
      %ul
        %li
          %p
            %strong= metric.sort_value
            = metric.vars_for_render[:friendly_name]
            %small
              %a.text-muted{'data-toggle' => 'collapse', 'data-target' => "\##{metric.vars_for_render[:name]}-#{metric.vars_for_render[:token]}"} show
            - unless metric.vars_for_render[:shared_resources].empty?
              .collapse{id: "#{metric.vars_for_render[:name]}-#{metric.vars_for_render[:token]}"}
                (
                = raw metric.vars_for_render[:shared_resources].map { |res| link_to res.name, resource_details_path(res.username)}.join(', ')
                )